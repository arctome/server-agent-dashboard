import{j as e,r as P,a as r,C as f,F as S,I as u,P as g,d as y,b as k,u as C,R as L,c as m,T as v,e as U,B as M}from"./vendor.03739286.js";const N=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const a of document.querySelectorAll('link[rel="modulepreload"]'))c(a);new MutationObserver(a=>{for(const s of a)if(s.type==="childList")for(const p of s.addedNodes)p.tagName==="LINK"&&p.rel==="modulepreload"&&c(p)}).observe(document,{childList:!0,subtree:!0});function i(a){const s={};return a.integrity&&(s.integrity=a.integrity),a.referrerpolicy&&(s.referrerPolicy=a.referrerpolicy),a.crossorigin==="use-credentials"?s.credentials="include":a.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function c(a){if(a.ep)return;a.ep=!0;const s=i(a);fetch(a.href,s)}};N();function T(n){const o=n.data,i=n.container;if(!o)return e("div",{children:"No data found!"});const[c,a]=P.exports.useState(!1);return r(Modal,{closeIcon:!0,open:c,trigger:e(Button,{content:"Detail",icon:"file alternate outline",labelPosition:"left"}),onClose:()=>a(!1),onOpen:()=>a(!0),children:[r(Header,{children:["Host: ",o.Host]}),e(Modal.Content,{children:e(Grid,{divided:"vertically",children:r(Grid.Row,{columns:2,children:[r(Grid.Column,{children:[e("h4",{children:"Server Detail Infomation: "}),r("p",{children:["CPU: ",o.CPU.ModelName," x",o.CPU.Cores]}),r("p",{children:["Exposed IP Address: ",o.OuterIPAddr]}),r("p",{children:["OS: ",o.System.Os,"@",o.System.OsVersion]}),r("p",{children:["Arch: ",o.System.Architecture]}),r("p",{children:["Virtualization: ",o.System.Virtualization]})]}),i&&i.length>0?r(Grid.Column,{children:[e("h4",{children:"Docker Status"}),i.map(s=>r("p",{className:"flex-justify-between",children:[e("span",{children:s.Name[0].replace("/","")}),e("span",{style:{color:s.State==="running"?"green":"orange"},children:s.State})]},s.ID))]}):null]})})})]})}var x="/assets/cib-debian.9f5efeb7.svg",O="/assets/cib-apple.2845b74a.svg",D="/assets/cib-arch-linux.5f83c398.svg",I="/assets/cib-centos.f5c3c47b.svg",_="/assets/cib-fedora.0e6e0535.svg",A="/assets/cib-gentoo.c3b63472.svg",E="/assets/cib-opensuse.30b6a869.svg",j="/assets/cib-redhat.2b180511.svg",H="/assets/cib-ubuntu.c0784c32.svg",R="/assets/cib-windows.c62a7e4e.svg",B="/assets/cib-linux.4a16d092.svg";function F(n){return e("i",{children:e("img",{src:{apple:O,"arch-linux":D,centos:I,debian:x,fedora:_,gentoo:A,opensuse:E,redhat:j,ubuntu:H,windows:R}[n.os.toLowerCase()]||B,alt:n.os})})}function G(){return e("div",{})}function q(n){return r("div",{style:{paddingBottom:20},children:[e(g,{progress:!0,percent:n.Percent.CPU,success:n.Percent.CPU<50,warning:n.Percent.CPU>=50&&n.Percent.CPU<80,error:n.Percent.CPU>=80,children:r("p",{className:"justify-between-label",children:[r("span",{children:[e(u,{name:"dashboard"}),"CPU Load 1/5/15:"]})," ",r("span",{children:[n.Load.CPU.load1,"/",n.Load.CPU.load5,"/",n.Load.CPU.load15]})]})}),e(g,{percent:n.Percent.Mem,progress:!0,success:n.Percent.Mem<50,warning:n.Percent.Mem>=50&&n.Percent.Mem<80,error:n.Percent.Mem>=80,children:r("p",{className:"justify-between-label",children:[r("span",{children:[e(u,{name:"microchip"}),"Memory:"]})," ",r("span",{children:[n.Load.Mem.Used,"MB/",n.Load.Mem.Total,"MB"]})]})}),e(g,{percent:n.Percent.Swap,progress:!0,success:n.Percent.Swap<50,warning:n.Percent.Swap>=50&&n.Percent.Swap<80,error:n.Percent.Swap>=80,children:r("p",{className:"justify-between-label",children:[r("span",{children:[e(u,{name:"disk"}),"Swap:"]})," ",r("span",{children:[n.Load.Swap.Used,"MB/",n.Load.Swap.Total,"MB"]})]})}),e(g,{percent:n.Percent.Disk,progress:!0,success:n.Percent.Disk<50,warning:n.Percent.Disk>=50&&n.Percent.Disk<80,error:n.Percent.Disk>=80,children:e("p",{className:"justify-between-label",children:r("span",{children:[e(u,{name:"disk"}),"Disk"]})})})]})}function W(n){const o=n.server,i=n.key;return P.exports.useEffect(()=>{console.log(o)},[]),r(f,{className:"server-card",children:[e(f.Content,{children:o.state?e(q,{state:o.state}):e(G,{})}),o.info?r(f.Header,{children:[e(S,{name:o.Location})," ",e(F,{os:o.info.System.Os})," ",o.Host," "]}):"",o.state?e(f.Meta,{children:r("div",{className:"flex-justify-between",children:[r("p",{children:[e(u,{name:"power off"})," Uptime: ",dayjs(Date.now()-o.state.Host.Uptime*1e3).fromNow(!0)]}),r("p",{children:[e(u,{name:"docker"})," ",o.state.Container.filter(c=>c.State==="running").length,"/",o.state.Container.length]})]})}):"",e(f.Content,{extra:!0,children:e("div",{className:"flex-justify-between",children:e(T,{data:o.info,container:o.state?o.state.Container:[]})})})]},i)}y.extend(k);function z(){const[n,o]=P.exports.useState([]);let i=C();function c(){const t=window.localStorage.getItem("Server-Agent-Token");return t||i("/login"),fetch("/api/list",{method:"GET",headers:{"Server-Agent-Token":t}}).then(l=>{if(l.ok&&l.status===200)return l.json()})}function a(t){return t.UseProxy?"wss://"+window.location.host:(t.EnableSSL?"wss":"ws")+"://"+t.Host+(t.EnableSSL&&t.Port==="443"?"":":"+t.Port)}function s(t,l){return t.UseProxy?"/socket/proxy?host="+t.Host+"&port="+t.Port+"&token="+l:"/socket/server?token="+l}function p(t){let l=new WebSocket(a(t)+s(t,window.localStorage.getItem("Server-Agent-Token")));t.socket=l,t.socket.onopen=function(){t.socket.send("info"),t.state={}},t.socket.onmessage=function(d){if(d.data==="info"||d.data==="state"||d.data==="ping")return;let h;try{h=JSON.parse(d.data)}catch(w){throw console.log("Failed to parse websocket data:"),console.log(d.data),w}switch(h.MessageType){case"info":{t._info=h,t.__UPDATE_TIMER__=setInterval(()=>{t.socket.send("state")},1e4);break}case"state":{t._proxy_state.state=h;break}case"pong":{console.log("keeping connection...");break}default:console.warn("Unrecognized message type:"),console.log(d.data)}},t.socket.onclose=function(){console.log("connection lost."),b()}}function b(){n.length<1||n.forEach(t=>{t.__UPDATE_TIMER__&&clearInterval(t.__UPDATE_TIMER__),t.socket&&t.socket.close&&t.socket.close()})}return P.exports.useEffect(async()=>{let t=await c().catch(l=>{console.log(l)});return o(t),n.forEach(l=>{p(l)}),function(){b()}},[]),e("main",{className:"page-home",children:e("div",{className:"server-list",children:n.map(t=>e(W,{server:t},t.Host))})})}function J(){return e("div",{})}function V(){return e("div",{})}function $(){function n(o){o.preventDefault();var i=new XMLHttpRequest;i.open("POST","/api/login",!0),i.setRequestHeader("Content-Type","application/json; charset=UTF-8"),i.withCredentials=!0,i.onload=function(){if(this.status>=200&&this.status<400){const c=JSON.parse(this.response);if(!c.ok){alert("fetch token failed"),console.log(this.response);return}window.localStorage.setItem("Server-Agent-Token",c.token),window.location.href="/"}},i.onerror=function(c){console.log(c),alert("Login request error, please try again later!")},i.send(JSON.stringify(Object.fromEntries(new FormData(o.target))))}return r("form",{id:"login-form",onSubmit:n,children:[e("label",{for:"form-user",children:"User: "}),e("input",{type:"text",id:"form-user",name:"user",value:"admin"}),e("label",{for:"form-pass",children:"Password: "}),e("input",{type:"password",id:"form-pass",name:"pass"}),e("button",{type:"submit",children:"Login"})]})}function K(){return r("div",{className:"App",children:[r(L,{children:[e(m,{path:"/terminal/:hashid",element:e(J,{})}),e(m,{path:"/login",element:e($,{})}),e(m,{path:"/",element:e(z,{})}),e(m,{path:"/*all",element:e(V,{})})]}),e(v,{})]})}U.render(e(M,{children:e(K,{})}),document.getElementById("root"));
